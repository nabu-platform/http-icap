# ClamAV

An example when we upload the EICAR test string:

```
REQMOD icap://neo-dev.cubitec.be:1344/squidclamav ICAP/1.0
Encapsulated: req-hdr=0, req-body=40
Host: neo-dev.cubitec.be:1344
Connection: Close

POST https://www.google.com HTTP/1.1

44
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
0


ICAP/1.0 200 OK
Server: C-ICAP/0.4.4
Connection: close
ISTag: CI0001-1-squidclamav-10
X-Virus-ID: Win.Test.EICAR_HDB-1
X-Infection-Found: Type=0; Resolution=2; Threat=Win.Test.EICAR_HDB-1;
Encapsulated: req-hdr=0, req-body=148

POST https://www.google.com HTTP/1.1
Via: ICAP/1.0 ip-172-31-28-168.eu-central-1.compute.internal (C-ICAP/0.4.4 SquidClamav/Antivirus service )

229
<html>
 <head>
   <title>SquidClamav: Unsafe Browsing detected!</title>
</head>

<body>
<h1>SquidClamAv: Virus or Unsafe Browsing detected!</h1>

<p>
The requested URL <b> https://www.google.com </b> contains a virus or is listed as suspicious.<br>
This page can not be displayed or the file cannot be downloaded.
</p>
<p>
Virus or Malware / pishing type: <b> Win.Test.EICAR_HDB-1 </b>
</p>
<p>
  For more information contact your system administrator
</p>
<hr>
<p>
This message generated by C-ICAP service: <b> squidclamav </b>
</p>

</body>
</html>
```

When we upload a safe content, we get:

```
REQMOD icap://neo-dev.cubitec.be:1344/squidclamav ICAP/1.0
Encapsulated: req-hdr=0, req-body=40
Host: neo-dev.cubitec.be:1344
Connection: Close

POST https://www.google.com HTTP/1.1

4
test
0


ICAP/1.0 200 OK
Server: C-ICAP/0.4.4
Connection: close
ISTag: CI0001-1-squidclamav-10
Encapsulated: req-hdr=0, req-body=148

POST https://www.google.com HTTP/1.1
Via: ICAP/1.0 ip-172-31-28-168.eu-central-1.compute.internal (C-ICAP/0.4.4 SquidClamav/Antivirus service )

4
test
0
```